<html>
<head>
  <title>Hajo's Bikertreff-Karte</title>
  <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css"/>
  <link rel="stylesheet" href="style/MarkerCluster.css"/>
  <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
  <script src="scripts/leaflet.markercluster.js"></script>
  <script src="scripts/jquery-2.1.1.min.js"></script>

<!--   <script src='togeojson.js'></script>
  <script>
    $.ajax('./bikertreff.gpx').done(function(xml) {
      console.log(toGeoJSON.gpx(gpx));
    });
  </script>
 -->

  <style>
    #map{ width: 100%; height: 100%; }
  </style>
</head>
<body>

  <div id="map"></div>

  <script>



  // initialize the map
  var map = L.map('map').setView([50.9513627, 7.2044041], 9);


  // load a tile layer
  L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
    {
      attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
      maxZoom: 19,
      minZoom: 1
    }).addTo(map);

  // load GeoJSON from an external file
  $.getJSON("./bikertreffs.geoJson",function(data){
      var bikertreffIcon = L.icon({
      iconUrl: 'bikertreff.png',
      iconSize: [40,45]
    });


//console.log(JSON.stringify(data));


    // add GeoJSON layer to the map once the file is loaded
    var rodents = L.geoJson(data,{
      pointToLayer: function(feature,latlng){
      	var marker = L.marker(latlng,{icon: bikertreffIcon});
        //marker.bindPopup(feature.properties.name + '<br/>' + feature.properties.desc + '<br/>'  + latlng);

        // Tooltip on mouse over
        marker.on('mouseover', function()
          {marker.bindPopup(
            feature.properties.name + '<br/>' + feature.properties.desc + '<br/>'  + latlng,
            {'offset': L.point(0,-15)}).openPopup();
        });
        marker.on('mouseout', function(){marker.closePopup();});

        return marker;
      }
    });
    var clusters = L.markerClusterGroup();
    clusters.addLayer(rodents);
    map.addLayer(clusters);





});




  </script>
</body>
</html>
